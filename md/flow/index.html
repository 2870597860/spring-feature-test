<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
        <title>flow</title>
</head>

<body>
    <canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">
        您的浏览器不支持 HTML5 canvas 标签。</canvas>
</body>
<script>
var cavans = document.getElementById("myCanvas");
var ctx = cavans.getContext("2d");

//添加文本框
/*setTimeout("addWordFrame(\"流程节点1\", 20, 10, 10)", 200);
setTimeout("addWordFrame(\"流程节点2\", 20, 200, 10)", 200);

setTimeout("addWordFrame(\"流程节点3\", 20, 100, 110)", 510);

setTimeout("addWordFrame(\"流程节点4\", 20, 100, 210)", 710);
setTimeout("addWordFrame(\"流程节点5\", 20, 100, 310)", 910);
setTimeout("addWordFrame(\"流程节点6\", 20, 100, 410)", 1110);
setTimeout("addWordFrame(\"流程节点7\", 20, 100, 510)", 1310);*/
addWordFrame("流程节点1", 20, 10, 10)
addWordFrame("流程节点2", 20, 200, 10)
addWordFrame("流程节点3", 20, 100, 110)
addWordFrame("流程节点4", 20, 100, 210)
addWordFrame("流程节点5", 20, 100, 310)
addWordFrame("流程节点6", 20, 100, 410)





//添加竖线
addLine(60, 44, 60, 70)
addLine(260, 44, 260, 70)

//横线
addLine(60, 70, 260, 70)

addLine(160, 70, 160, 106)
addLine(160, 144, 160, 206)
addLine(160, 244, 160, 306)
addLine(160, 344, 160, 406)

//线
function addLine(startX, startY, endX, endY) {

    ctx.beginPath();
    ctx.moveTo(startX, startY);
    ctx.lineTo(endX, endY);
    ctx.stroke();
}

function function_name(argument) {
    // body...
}

//文本框
function addWordFrame(word, fontSize, x, y) {
    var length = word.length + 1;

    var w = length * 20;
    var h = fontSize + 10;
    ctx.fillStyle = "#ff0022";
    ctx.fillRect(x - 4, y - 4, w + 8, h + 8);

    //长方形
    ctx.fillStyle = "#222222";
    ctx.fillRect(x, y, w, h);

    //文字
    ctx.fillStyle = "#ffffff";
    ctx.font = fontSize + "px Arial";
    ctx.fillText(word, x + fontSize / 2 + 10, y + fontSize / 2 + 10);
}

//选取文本框
function addActiveWordFrame(word, fontSize, x, y) {
    var length = word.length + 1;

    var w = length * 20;
    var h = fontSize + 10;
    ctx.fillStyle = "#22b9ed";
    ctx.fillRect(x - 4, y - 4, w + 8, h + 8);

    //长方形
    ctx.fillStyle = "#222222";
    ctx.fillRect(x, y, w, h);

    //文字
    ctx.fillStyle = "#ffffff";
    ctx.font = fontSize + "px Arial";
    ctx.fillText(word, x + fontSize / 2 + 10, y + fontSize / 2 + 10);
}

//计算canvas上面的坐标
function windowToCanvas(e) {
    var x = e.clientX;
    var y = e.clientY;
    var point = cavans.getBoundingClientRect();

    x = Math.round(x - point.left);
    y = Math.round(y - point.top);
    return {x: x, y: y};
}

cavans.on('click',function(e){
    alert(windowToCanvas(e));
})
</script>

</html>
